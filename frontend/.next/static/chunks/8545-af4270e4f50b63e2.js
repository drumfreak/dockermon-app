"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8545],{18545:function(e,t,r){r.d(t,{h:function(){return A}});var n=r(34051),s=r.n(n),c=r(85893),o=r(11163),a=r(67294),i=r(40424),l=r(87536),u=r(95496),d=r(74231),m=r(99403),p=r(25600),f=r(46479),h=r(28565),v=r(49861),x=r(42670),b=r(43964),j=r(91176),g=r(92814),N=r(51436),y=r(91202),k=r(3718),w=r(23627);function H(e,t,r,n,s,c,o){try{var a=e[c](o),i=a.value}catch(l){return void r(l)}a.done?t(i):Promise.resolve(i).then(n,s)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var c=e.apply(t,r);function o(e){H(c,n,s,o,a,"next",e)}function a(e){H(c,n,s,o,a,"throw",e)}o(void 0)}))}}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){R(e,t,r[t])}))}return e}function A(e){var t,r,n,H,R,A=function(){z.current&&z.current.emit("hosts",{command:"listHosts",callback:"hostsList"})},T=function(){return v.W.generateName()},L=(0,o.useRouter)(),F=(0,a.useRef)(null),I=(0,a.useState)()[0];(0,a.useRef)(I).current=I;var P=(0,a.useState)(!1),E=P[0],O=P[1],q=(0,a.useState)(!0),W=q[0],_=q[1],D=(0,a.useRef)(W);D.current=W;var B=(0,a.useState)(),V=B[0],$=B[1],z=(0,a.useRef)(V);z.current=V;var G=(0,a.useState)(!1),J=G[0],U=G[1],X=(0,a.useState)("http"),Z=X[0],K=X[1],M=(0,a.useRef)(Z);M.current=Z;var Q=(0,a.useState)(!0),Y=Q[0],ee=Q[1],te=(0,a.useRef)(Y);te.current=Y;var re=(0,a.useState)(!1),ne=re[0],se=re[1],ce=(0,a.useRef)(ce);ce.current=ne;var oe=(0,a.useState)(!1),ae=oe[0],ie=oe[1],le=(0,a.useRef)(ae);le.current=ae;var ue=(0,a.useState)(2375),de=ue[0],me=ue[1],pe=(0,a.useRef)(de);pe.current=de;var fe=(0,a.useState)(!1),he=fe[0],ve=fe[1],xe=(0,a.useRef)(he);xe.current=he;var be=(0,a.useState)(),je=be[0],ge=be[1],Ne=(0,a.useRef)(je);Ne.current=je;var ye=(0,a.useState)(),ke=ye[0],we=ye[1],He=(0,a.useRef)(ke);He.current=ke;var Se=(0,a.useState)(),Re=Se[0],Ce=Se[1],Ae=(0,a.useRef)(Re);Ae.current=Re,(0,a.useEffect)(S(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=3;break}return e.next=3,Le();case 3:_(!1);case 4:case"end":return e.stop()}}),e)}))),[]),(0,a.useEffect)((function(){e.mode&&Ce(e.mode),e.host&&(ve(!0),we(e.host),setTimeout((function(){return function(){return Ie.apply(this,arguments)}()}),300))}),[e.host,e.mode]),(0,a.useEffect)((function(){return function(){z.current&&z.current.removeListener("createHostForm")}}),[]);var Te=function(){F.current.clear()};function Le(){return Fe.apply(this,arguments)}function Fe(){return(Fe=S(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!J){e.next=2;break}return e.abrupt("return");case 2:return U(!0),e.next=5,h.L.getSocket();case 5:return(t=e.sent).on("createHostForm",(function(e){ve(!1),z.current.emit("docker",{command:"listHosts",callback:"hostsList"}),"success"===e.status&&(A(),(0,i.V)({className:"confirm-dialogs",message:"Would you like to view it now?",header:"edit"===Ae.current?"Host Updated":"Host Created",icon:"pi pi-exclamation-check",accept:function(){return L.push("/hosts/"+e.data.id)},reject:function(){return _(!1)}})),e.error&&(E||O(!0),_(!1))})),$(t),e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(){return(Ie=S(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(He.current){e.next=2;break}return e.abrupt("return");case 2:if(D.current&&_(!0),!He.current){e.next=11;break}return e.next=6,w.d.getHostById(He.current);case 6:(t=e.sent)&&"success"===t.status&&(ge(t.data),We("name",t.data.name),We("ipAddress",t.data.ipAddress),We("connectionType",t.data.connectionType),We("port",t.data.port),me(t.data.port),!0===t.data.active?ee(!0):ee(!1),!0===t.data.windowsHost?se(!0):se(!1),!0===t.data.protected?ie(!0):ie(!1)),ve(!1),e.next=12;break;case 11:D.current&&_(!1);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pe=d.Ry({name:d.Z_().required(),ipAddress:d.Z_().required(),port:d.Rx().required()}).required(),Ee=(0,l.cI)({resolver:(0,u.X)(Pe)}),Oe=Ee.register,qe=Ee.handleSubmit,We=Ee.setValue,_e=Ee.formState.errors;return W?(0,c.jsx)(x.$,{}):"edit"!==Ae.current||Ne.current?(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{children:["edit"===Ae.current&&(0,c.jsxs)("h2",{children:["Edit Host - ",null===Ne||void 0===Ne||null===(t=Ne.current)||void 0===t?void 0:t.name]}),"edit"!==Ae.current&&(0,c.jsx)("h2",{children:"Join a Host"}),(0,c.jsx)(b.s,{className:"col-8 md:8 m-auto",children:(0,c.jsx)("div",{className:"card",children:(0,c.jsx)("form",{onSubmit:qe((function(e){Te(),ve(!0);var t={name:e.name,ipAddress:e.ipAddress,port:pe.current,active:te.current,windowsHost:ce.current,protected:le.current,connectionType:M.current};_(!0);var r="createHost";"edit"===Ae.current&&(r="editHost",t.id=He.current),z.current.emit("hosts",{command:r,data:t,callback:"createHostForm",hook:"createHost"})})),children:(0,c.jsxs)("div",{className:"p-fluid p-formgrid p-grid mt-5 ml-auto mr-auto jc-center",children:[(0,c.jsxs)(b.s,{className:"mt-3",header:"Basic Details",toggleable:!0,children:[(0,c.jsx)("div",{className:"form-group",children:(0,c.jsxs)("div",{className:"p-field mt-2 col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"name",children:"Name"}),(0,c.jsxs)("div",{className:"p-inputgroup",children:[(0,c.jsx)(p.o,C({id:"name",keyfilter:/^[^<>*!\s]+$/,name:"name",type:"text",required:!0,disabled:xe.current},Oe("name",{value:T()}),{className:"form-control f-height-inputs ".concat(_e.name?"p-invalid":"")}),"name"),(0,c.jsx)("div",{className:"p-inputgroup-addon",children:(0,c.jsx)(m.z,{className:"p-button p-button-secondary",disabled:xe.current,onClick:function(e){e.preventDefault();var t=T();We("name",t)},children:(0,c.jsx)(g.G,{icon:N.qiA})})})]}),(0,c.jsx)("div",{className:"invalid-feedback",children:null===(r=_e.name)||void 0===r?void 0:r.message})]})}),(0,c.jsx)("div",{className:"form-group mt-5",children:(0,c.jsxs)("div",{className:"mt-4 p-field col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"project",children:"Connection Type"}),(0,c.jsxs)("div",{className:"p-inputgroup",children:[(0,c.jsx)(y.L,C({name:"connectionType",id:"connectionType",options:["http","https","ws"],placeholder:"Connection Type",disabled:xe.current},Oe("connectionType",{value:"http"}),{onChange:function(e){K(e.value),We("connectionType",e.value)},value:null===M||void 0===M?void 0:M.current,className:"form-control f-height-inputs ".concat(_e.connectionType?"p-invalid":"")}),"connectionType"),(0,c.jsx)("div",{className:"invalid-feedback",children:null===(n=_e.connectionType)||void 0===n?void 0:n.message})]})]})}),(0,c.jsxs)("div",{className:"form-group mt-5",children:[(0,c.jsxs)("div",{className:"mt-4 p-field col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"driver",children:"IP Address or Hostname"}),(0,c.jsx)(p.o,C({id:"ipAddress",name:"ipAddress",type:"text",placeholder:"192.168.100.10",disabled:xe.current},Oe("ipAddress",{value:null}),{className:"form-control f-height-inputs ".concat(_e.ipAddress?"p-invalid":"")}),"ipAddress"),(0,c.jsx)("div",{className:"invalid-feedback",children:null===(H=_e.ipAddress)||void 0===H?void 0:H.message})]}),(0,c.jsxs)("div",{className:"mt-4 p-field col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"driver",children:"Port Number"}),(0,c.jsx)(j.R,C({min:1,inputId:"port",placeholder:"2375",step:1,max:99999999,useGrouping:!1,showButtons:!1,value:pe.current,disabled:xe.current},Oe("port",{value:2375}),{tooltip:"The port number.",onChange:function(e){return me(e.value)}})),(0,c.jsx)("div",{className:"invalid-feedback",children:null===(R=_e.port)||void 0===R?void 0:R.message})]})]}),(0,c.jsxs)("div",{className:"form-group mt-5",children:[(0,c.jsxs)("div",{className:"mt-4 p-field col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"project",children:"Host Status"}),(0,c.jsx)("div",{className:"col-6 ml-auto mr-auto",children:(0,c.jsx)(k.C,{tooltip:"Enable or Disable backend stats collection and status updates jobs for this host",className:"col-6 m-auto",checked:Y,onChange:function(e){return ee(e.value)},onLabel:"Active",offLabel:"Disabled",onIcon:"pi pi-check",offIcon:"pi pi-times"})})]}),(0,c.jsxs)("div",{className:"mt-4 p-field col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"project",children:"Host Protected"}),(0,c.jsx)("div",{className:"col-6 ml-auto mr-auto",children:(0,c.jsx)(k.C,{tooltip:"Prevent this host from being deleted",className:"col-6 m-auto",checked:le.current,onChange:function(e){return ie(e.value)},onLabel:"Protected",offLabel:"Not Protected",onIcon:"pi pi-check",offIcon:"pi pi-times"})})]}),(0,c.jsxs)("div",{className:"mt-4 p-field col-12 col-md-6 col-lg-4 col-xl-4 text-left",children:[(0,c.jsx)("label",{htmlFor:"project",children:"Windows NON-Linux Host"}),(0,c.jsx)("div",{className:"col-6 ml-auto mr-auto",children:(0,c.jsx)(k.C,{tooltip:"If this is a NON-Linux Windows Host, enable this for extra features",className:"col-6 m-auto",checked:ce.current,onChange:function(e){return se(e.value)},onLabel:"Windows",offLabel:"Not Windows",onIcon:"pi pi-check",offIcon:"pi pi-times"})})]})]})]}),(0,c.jsx)("div",{className:"col-6 ml-auto mr-auto mt-5",children:(0,c.jsx)(m.z,{disabled:xe.current,className:"p-button p-button-primary p-3",type:"submit",label:"edit"!==Ae.current?"Join Host":"Edit Host"})}),(0,c.jsx)(f.V,{ref:F})]})})})},"containerForm")]})}):(0,c.jsx)(x.$,{})}},23627:function(e,t,r){r.d(t,{d:function(){return l}});var n=r(22946),s=r(11752),c=r(51388),o=(0,s.default)().publicRuntimeConfig,a="".concat(o.apiUrl),i=new n.X(""),l={results:i.asObservable(),getHosts:function(e){return c.h.post("".concat(a,"/hosts"),e).then((function(e){if("success"===e.status)return i.next(e),e;throw Error(e.message)})).catch((function(e){i.next(null),console.log(e)}))},getHostById:function(e){return c.h.get("".concat(a,"/hosts/").concat(e)).then((function(e){if("success"===e.status)return i.next(e),e;throw Error(e.message)})).catch((function(e){i.next(null),console.log(e)}))}}}}]);