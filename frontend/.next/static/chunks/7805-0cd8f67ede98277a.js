"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7805],{7805:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(34051),a=n.n(r),s=n(85893),o=n(67294),c=n(11163),i=n(41664),u=n(66367),l=n(51436),d=n(25617),f=n(81961),p=n(27484),v=n.n(p),h=n(40424),g=n(99403),m=n(92814),x=n(25600),b=n(42896),y=n(58650),j=n(12018),N=n(22727),w=n(91202),k=n(69868),P=n(13643);function S(e,t,n,r,a,s,o){try{var c=e[s](o),i=c.value}catch(u){return void n(u)}c.done?t(i):Promise.resolve(i).then(r,a)}function L(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){S(s,r,a,o,c,"next",e)}function c(e){S(s,r,a,o,c,"throw",e)}o(void 0)}))}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){(0,c.useRouter)();var t=(0,o.useState)(!0),n=t[0],r=t[1];(0,o.useRef)(n).current=n;var p=(0,o.useState)()[0],S=(0,d.v9)((function(e){return e.hosts.activeHost})),R=(0,o.useRef)(S);R.current=S;var T=(0,o.useState)(!1)[0];(0,o.useRef)(T).current=T;var A=(0,o.useState)(),I=A[0],O=A[1],D=(0,o.useRef)(I);D.current=I;var E=(0,o.useState)(),H=E[0],F=E[1],M=(0,o.useRef)(H);M.current=H;var Y=(0,o.useState)()[0];(0,o.useRef)(Y).current=Y;var K=(0,o.useState)(),_=K[0],G=(K[1],(0,o.useRef)(_));G.current=_;var V=(0,o.useState)(!1),z=(V[0],V[1],(0,o.useState)()),B=z[0],U=z[1],X=(0,o.useRef)(B);X.current=B;var Z=(0,o.useState)([]),q=Z[0],J=Z[1],Q=(0,o.useRef)({});Q.current=q;var W=(0,o.useState)(),$=W[0],ee=W[1],te=(0,o.useRef)($);te.current=$;var ne=(0,o.useState)(),re=ne[0],ae=ne[1],se=(0,o.useState)(""),oe=se[0],ce=se[1],ie=(0,o.useState)(!0),ue=ie[0],le=ie[1];(0,o.useRef)(ue).current=ue;var de=(0,o.useState)(1),fe=de[0],pe=de[1];(0,o.useRef)(fe).current=fe;var ve=(0,o.useState)("Press 'Enter' key to go to this page."),he=ve[0],ge=ve[1],me=(0,o.useState)(1),xe=me[0],be=me[1],ye=(0,o.useRef)(xe);ye.current=xe;var je=(0,o.useState)(25),Ne=je[0],we=je[1],ke=(0,o.useRef)(Ne);ke.current=Ne;var Pe=(0,o.useState)(0),Se=Pe[0],Le=Pe[1];(0,o.useRef)(Se).current=Se;var Ce=(0,o.useState)("updatedAt"),Re=Ce[0],Te=(Ce[1],(0,o.useRef)(Re));Te.current=Re;var Ae=(0,o.useState)(-1),Ie=Ae[0];Ae[1];(0,o.useRef)(Ie).current=Ie;function Oe(){return De.apply(this,arguments)}function De(){return(De=L(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={limit:ke.current,skip:ye.current,sortKey:Te.current,sortType:"DESC"},D.current&&(t.contentType=D.current),M.current&&(t.contentId=M.current),e.next=5,f.u.getActivityLogs(t);case 5:if("success"!==(null===(n=e.sent)||void 0===n?void 0:n.status)){e.next=12;break}return e.next=9,U(n.data);case 9:return e.next=11,Le(n.totalCount);case 11:setTimeout((function(){Ee()}),100);case 12:r(!1),le(!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return He.apply(this,arguments)}function He(){return(He=L(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(t=X.current)||void 0===t?void 0:t.length)>0&&(n=X.current.map((function(e){return{status:e.contentName+e.action,date:v()(e.updatedAt).format("YYYY-MM-DD HH:mm:ss"),icon:"pi pi-shopping-cart",color:"#9C27B0"}})))&&(Q.current=n,J(n)),le(!1);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if((0,o.useEffect)((function(){e.contentTypeLogs&&O(e.contentTypeLogs),e.contentId&&F(e.contentId),setTimeout((function(){Fe(),Oe()}),400)}),[]),(0,o.useEffect)((function(){e.contentTypeLogs&&O(e.contentTypeLogs),e.contentId&&F(e.contentId),setTimeout((function(){Fe(),Oe()}),400)}),[e.contentId]),p)return(0,s.jsxs)("div",{children:["Failed to load ActivityLogs: ",p]});var Fe=function(){ae({global:{value:null,matchMode:u.a6.CONTAINS},name:{operator:u.pg.AND,constraints:[{value:null,matchMode:u.a6.CONTAINS}]},project:{operator:u.pg.AND,constraints:[{value:null,matchMode:u.a6.CONTAINS}]},containerId:{operator:u.pg.AND,constraints:[{value:null,matchMode:u.a6.CONTAINS}]}})},Me=function(e){G.current.emit("docker",{command:"removeActivityLog",activityLogId:e.activityLogId,hostId:R.current.id,callback:"dockerResuls_activityLogs"+e.id,hook:"removeActivityLog"})},Ye=function(){te.current.forEach((function(e){var t;0===(null===(t=e.containers)||void 0===t?void 0:t.length)&&Me(e)})),ee(null)},Ke=function(e){pe(e.target.value)},_e={layout:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown CurrentPageReport",FirstPageLink:function(e){return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,disabled:e.disabled,children:[(0,s.jsx)("span",{className:"p-3",children:"<<"}),(0,s.jsx)(k.H,{})]})},PrevPageLink:function(e){return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,disabled:e.disabled,children:[(0,s.jsx)("span",{className:"p-3",children:"Previous"}),(0,s.jsx)(k.H,{})]})},NextPageLink:function(e){return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,disabled:e.disabled,children:[(0,s.jsx)("span",{className:"p-3",children:"Next"}),(0,s.jsx)(k.H,{})]})},PageLinks:function(e){if(e.view.startPage===e.page&&0!==e.view.startPage||e.view.endPage===e.page&&e.page+1!==e.totalPages)(0,P.AK)(e.className,{"p-disabled":!0});return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,children:[e.page+1,(0,s.jsx)(k.H,{})]})},LastPageLink:function(e){return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,disabled:e.disabled,children:[(0,s.jsx)("span",{className:"p-3",children:">>"}),(0,s.jsx)(k.H,{})]})},RowsPerPageDropdown:function(e){return(0,s.jsx)(w.L,{value:e.value,options:[{label:10,value:10},{label:15,value:15},{label:25,value:25},{label:50,value:50},{label:100,value:100},{label:150,value:150}],onChange:e.onChange})},CurrentPageReport:function(e){return(0,s.jsxs)("span",{className:"mx-3",style:{color:"var(--text-color)",userSelect:"none"},children:["Go to ",(0,s.jsx)(x.o,{size:"2",className:"ml-1",value:fe,tooltip:he,onKeyDown:function(t){return function(e,t){if("Enter"===e.key){var n=parseInt(fe);if(n<0||n>t.totalPages)ge("Value must be between 1 and ".concat(t.totalPages,"."));else{var r=fe?t.rows*(n-1):0;be(r),ge("Press 'Enter' key to go to this page.")}}}(t,e)},onChange:Ke})]})}};return(0,s.jsxs)("div",{className:"col-12 p-0 m-0",children:[(0,s.jsxs)("div",{className:"col-12 p-0 m-0 pr-1 grid",children:[(0,s.jsx)("div",{className:"col-6",children:(0,s.jsxs)("h2",{children:[(0,s.jsx)(m.G,{icon:l.l5Z,pull:"left",className:"fa-1x lightblue-color mt-0 pt-0",swapOpacity:!0}),"Activity Logs"]})}),(0,s.jsxs)("div",{className:"col-6 text-right pr-0",children:[(0,s.jsxs)("span",{className:"p-input-icon-left mr-3",children:[(0,s.jsx)("i",{className:"pi pi-search"}),(0,s.jsx)(x.o,{value:oe,onChange:function(e){var t=e.target.value,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){C(e,t,n[t])}))}return e}({},re);n.global.value=t,ae(n),ce(t)},placeholder:"Keyword Search"})]}),(0,s.jsx)("button",{className:"p-button p-component p-button-secondary mt-1 p-2",label:"",onClick:function(){return Oe()},children:(0,s.jsx)(m.G,{icon:l.lUd,className:"mt-0 p-1",swapOpacity:!0})})]})]}),T&&(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("h6",{children:"Timeline"}),(0,s.jsx)(j.T,{value:q,layout:"vertical",align:"top",content:function(e){return e.status+" "+e.date}})]}),(0,s.jsxs)(b.w,{value:B,stripedRows:!0,rowHover:!0,showGridlines:!0,rows:Ne,totalRecords:null===B||void 0===B?void 0:B.length,dataKey:"id",sortMode:"single",sortField:Re,sortOrder:Ie,loading:ue,globalFilterFields:["name","contentId","action"],children:[(0,s.jsx)(y.s,{style:{width:"220px"},field:"updatedAt",header:"Date",body:function(e){var t="/activity/"+e.id;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.default,{href:t,children:(0,s.jsx)("a",{className:"lightblue-color",children:(0,s.jsx)("b",{children:v()(e.updatedAt).format("MM/DD/YYYY - h:mm:ss a")})})})})}}),(0,s.jsx)(y.s,{style:{width:"220px"},field:"host.name",body:function(e){if(!e.host)return(0,s.jsx)("div",{});var t="/hosts/"+e.host.id;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.default,{tooltip:"View "+e.host.name,href:t,children:(0,s.jsx)("a",{className:"lightblue-color",children:(0,s.jsx)("b",{children:e.host.name})})})})},header:"Host"}),(0,s.jsx)(y.s,{style:{width:"150px"},field:"contentType",header:"Type",align:"left"}),(0,s.jsx)(y.s,{field:"contentName",body:function(e){var t="/"+e.contentType+"/"+e.contentId;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.default,{href:t,children:(0,s.jsx)("a",{className:"lightblue-color",children:(0,s.jsx)("b",{children:e.contentName})})})})},header:"Name",align:"left"}),(0,s.jsx)(y.s,{style:{width:"320px"},field:"action",body:function(e){return(0,s.jsx)("div",{children:e.action})},header:"action",align:"center"})]}),(0,s.jsx)(N.D,{template:_e,first:xe,rows:Ne,totalRecords:Se,onPageChange:function(e){le(!0),e.rows!==ke.current?setTimeout((function(){we(e.rows),be(0),pe(1),Oe()}),100):setTimeout((function(){be(e.first),pe(e.page+1),Oe()}))}}),(null===$||void 0===$?void 0:$.length)>0&&(0,s.jsx)("div",{className:"col-12 text-right pr-2",children:(0,s.jsx)(g.z,{className:"mt-2 p-button-warning",label:"Remove Selected",icon:"fa fa-trash",onClick:function(e){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,h.V)({className:"confirm-dialogs",message:n,target:(null===r||void 0===r?void 0:r.currentTarget)?r.currentTarget:null,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:function(){switch(e){case"removeActivityLog":Me(t);break;case"removeSelected":Ye()}}})}("removeSelected",null,"Remove Selected Activity Logs?",e)}})})]})}},81961:function(e,t,n){n.d(t,{u:function(){return u}});var r=n(22946),a=n(11752),s=n(51388),o=(0,a.default)().publicRuntimeConfig,c="".concat(o.apiUrl),i=new r.X(""),u={results:i.asObservable(),getActivityLogs:function(e){return s.h.post("".concat(c,"/activityLogs"),e).then((function(e){if("success"===e.status)return i.next(e),e;throw Error(e.message)})).catch((function(e){i.next(null),console.log(e)}))},getActivityLogById:function(e){return s.h.get("".concat(c,"/activityLogs/").concat(e)).then((function(e){if("success"===e.status)return i.next(e),e;throw Error(e.message)})).catch((function(e){i.next(null),console.log(e)}))}}}}]);