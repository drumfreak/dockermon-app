"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4530],{14530:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var n=a(34051),r=a.n(n),s=a(85893),u=a(42670),i=a(67294),l=a(99403),o=a(58650),c=a(27484),d=a(16270),f=a(40424),m=a(22727),p=a(74420),g=a(28565),v=a(69868),h=a(91202),x=a(25600),j=a(13643),b=a(25617),k=a(12199),y=a(42552);function w(e,t,a,n,r,s,u){try{var i=e[s](u),l=i.value}catch(o){return void a(o)}i.done?t(l):Promise.resolve(l).then(n,r)}function N(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var s=e.apply(t,a);function u(e){w(s,n,r,u,i,"next",e)}function i(e){w(s,n,r,u,i,"throw",e)}u(void 0)}))}}function P(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var a=1024,n=t<0?0:t,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,s)).toFixed(n))+" "+r[s]},a=(0,i.useRef)(null),n=(0,i.useRef)(),w=(0,b.v9)((function(e){return e.hosts.activeHost})),P=(0,i.useRef)(w);P.current=w;var _=(0,b.v9)((function(e){return e.images})),S=(0,i.useState)([]),R=S[0],C=S[1],I=(0,i.useState)(""),z=I[0],E=I[1],F=(0,i.useState)(""),H=F[0],L=F[1],B=(0,i.useState)(null),T=B[0],M=B[1];(0,i.useRef)(T).current=T;var D=(0,i.useState)(null),Y=D[0],K=D[1],G=(0,i.useState)({}),A=G[0],V=G[1],O=(0,i.useState)(null),U=O[0],Z=O[1],$=(0,i.useState)(null),q=$[0],J=$[1],Q=(0,i.useRef)(q);Q.current=q;var W=(0,i.useState)(null),X=W[0],ee=W[1];(0,i.useRef)(X).current=X;var te=(0,i.useState)(null),ae=te[0],ne=te[1],re=(0,i.useRef)(ae);re.current=ae;var se=(0,i.useState)(null)[0];(0,i.useRef)(se).current=se;var ue=(0,i.useState)(!1),ie=ue[0],le=ue[1],oe=(0,i.useState)(!0),ce=oe[0],de=oe[1],fe=(0,i.useState)(!0),me=fe[0],pe=fe[1];(0,i.useRef)(me).current=me;var ge=(0,i.useState)(!0),ve=ge[0],he=ge[1];(0,i.useRef)(ve).current=ve;var xe=(0,i.useState)(null),je=xe[0],be=xe[1],ke=(0,i.useRef)(je);ke.current=je;var ye=(0,i.useState)(!1),we=ye[0],Ne=ye[1],Pe=(0,i.useState)(1),_e=Pe[0],Se=Pe[1],Re=(0,i.useRef)(_e);Re.current=_e;var Ce=(0,i.useState)("Press 'Enter' key to go to this page."),Ie=Ce[0],ze=Ce[1],Ee=(0,i.useState)(1),Fe=Ee[0],He=Ee[1],Le=(0,i.useState)(15),Be=Le[0],Te=Le[1],Me=(0,i.useRef)(Be);Me.current=Be;var De=(0,i.useState)(0),Ye=De[0],Ke=De[1];(0,i.useRef)(Ye).current=Ye;var Ge=(0,i.useState)([]),Ae=Ge[0],Ve=Ge[1],Oe=(0,i.useRef)(Ae);Oe.current=Ae,(0,i.useEffect)(N(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Ue(),Qe(),J(e.image),ne(e.imageId),we){t.next=7;break}return t.next=7,Ze();case 7:qe(),M([]);case 9:case"end":return t.stop()}}),t)}))),[]),(0,i.useEffect)((function(){Qe()}),[_]),(0,i.useEffect)((function(){Oe.current.length>0&&at()}),[Ae]),(0,i.useEffect)((function(){return function(){if(ke.current){var e="image_tags_"+re.current;ke.current.removeListener(e);var t="image_pull_"+re.current;ke.current.removeListener(t)}}}),[]);var Ue=function(){Y&&K(null)};function Ze(){return $e.apply(this,arguments)}function $e(){return $e=N(r().mark((function t(){var n,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!we){t.next=2;break}return t.abrupt("return");case 2:return Ne(!0),n="image_tags_"+e.imageId,t.next=6,g.L.getSocket();case 6:return(s=t.sent).on(n,(function(e){var t;(de(!0),"success"===(null===e||void 0===e?void 0:e.status))&&((null===e||void 0===e?void 0:e.data.count)&&Ke(e.data.count),(null===(t=e.data)||void 0===t?void 0:t.tags)&&(ee(e.data.tags),Xe({tags:e.data.tags,image:Q.current})))})),s.on("image_pull_"+re.current,function(){var e=N(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de(!1),"success"===t.status&&(L(t.data.status),n=(null===Oe||void 0===Oe?void 0:Oe.current)?Oe.current:"",t.data.progress?(n+=t.data.progress+"\n",Ve(n)):(n+=t.data.status+"\n",Ve(n))),"fail"===t.status&&(console.warn("Fail",t.message),E("Error: "+t.message),L("Fail: "+t.status),a.current.show({severity:"error",summary:"Error",detail:t.message,life:6e3}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),be(s),t.abrupt("return",s);case 11:case"end":return t.stop()}}),t)}))),$e.apply(this,arguments)}function qe(){return Je.apply(this,arguments)}function Je(){return(Je=N(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:he(!0),ke.current.emit("docker",{command:"dockerHubRepositoryTags",repository:re.current,options:{limit:Me.current,page:Re.current},callback:"image_tags_"+re.current});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){return We.apply(this,arguments)}function We(){return(We=N(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(_).map((function(e){return _[e]})),C(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(e){return et.apply(this,arguments)}function et(){return(et=N(r().mark((function e(t){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.tags){e.next=2;break}return e.abrupt("return");case 2:a=t.tags.map((function(e,a){var n={key:""+a,data:{id:e.id,name:e.name,last_updated:e.last_updated,size:e.full_size,data:e,status:e.tag_status,os:"",install:t.image.namespace+"/"+t.image.name+":"+e.name}};return n.children=e.images.map((function(n,r){return{key:a+"-"+r,data:{id:n.digest,name:n.architecture,last_updated:n.last_pushed,size:n.size,data:n,status:n.status,os:n.os,features:n.features,os_version:n.os_version,install:t.image.namespace+"/"+t.image.name+":"+e.name,platform:n.architecture}}})),n})),Z(a),pe(!1),he(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var tt=function(){var e;return 0===(null===(e=Oe.current)||void 0===e?void 0:e.length)?(0,s.jsx)("div",{}):Oe.current?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"col-12 ml-2 mr-2",children:(0,s.jsx)(y.g,{ref:n,autoCorrect:"off",spellCheck:"false",autoComplete:"false",autoCapitalize:"false",style:{backgroundColor:"black",padding:"4px"},value:Oe.current,onChange:function(){},className:"col-12 p-5",rows:10,cols:30})})}):(0,s.jsx)("div",{})},at=function(){var e=n.current;if(e){var t=e.scrollHeight-e.clientHeight;e.scrollTop=t>0?t:0}};if(!U)return(0,s.jsx)("div",{children:"No Results"});var nt=function(e){le(!0),ke.current&&ke.current.emit("dockerPullImage",{callback:"image_pull_"+re.current,command:"pullImage",hostId:P.current.id,body:{tag:e.data.install},data:e.data})},rt=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,k.w)({message:a,target:(null===n||void 0===n?void 0:n.currentTarget)?n.currentTarget:null,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:function(){if("removeImage"===e)ut(t)}})},st=function(e,t,a){(0,f.V)({message:t,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:function(){return e(a)}})},ut=function(e){var t;ke.current.emit("docker",{command:"removeImage",imageId:e.imageId,hostId:null===(t=e.host)||void 0===t?void 0:t.id,callback:"dockerResuls_images"+e.id,hook:"removeImage"})},it=function(e){Se(e.target.value)},lt={layout:"PrevPageLink PageLinks NextPageLink RowsPerPageDropdown CurrentPageReport",PrevPageLink:function(e){return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,disabled:e.disabled,children:[(0,s.jsx)("span",{className:"p-3",children:"Previous"}),(0,s.jsx)(v.H,{})]})},NextPageLink:function(e){return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,disabled:e.disabled,children:[(0,s.jsx)("span",{className:"p-3",children:"Next"}),(0,s.jsx)(v.H,{})]})},PageLinks:function(e){if(e.view.startPage===e.page&&0!==e.view.startPage||e.view.endPage===e.page&&e.page+1!==e.totalPages){var t=(0,j.AK)(e.className,{"p-disabled":!0});return(0,s.jsx)("span",{className:t,style:{userSelect:"none"},children:"..."})}return(0,s.jsxs)("button",{type:"button",className:e.className,onClick:e.onClick,children:[e.page+1,(0,s.jsx)(v.H,{})]})},RowsPerPageDropdown:function(e){return(0,s.jsx)(h.L,{value:e.value,options:[{label:10,value:10},{label:15,value:15},{label:20,value:20},{label:30,value:30}],onChange:e.onChange})},CurrentPageReport:function(e){return(0,s.jsxs)("span",{className:"mx-3",style:{color:"var(--text-color)",userSelect:"none"},children:["Go to ",(0,s.jsx)(x.o,{size:"2",className:"ml-1",value:_e,tooltip:Ie,onKeyDown:function(t){return function(e,t){if("Enter"===e.key){var a=parseInt(_e);if(a<0||a>t.totalPages)ze("Value must be between 1 and ".concat(t.totalPages,"."));else{var n=_e?t.rows*(a-1):0;He(n),ze("Press 'Enter' key to go to this page.")}}}(t,e)},onChange:it})]})}};return me?(0,s.jsx)(u.$,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.F,{ref:a}),!ce&&(0,s.jsxs)("div",{className:"card mb-4 mt-0 text-left",children:[(0,s.jsxs)("div",{className:"flex mt-0",children:[(0,s.jsx)("div",{className:"col-10 text-left p-5 m-auto pt-0",children:(0,s.jsx)("h3",{className:"lightblue-color",children:q.name})}),(0,s.jsx)("div",{className:"col-2 text-right p-5 m-auto mt-0 pt-0",children:(0,s.jsx)(l.z,{label:"Hide",onClick:function(){return le(!1),void de(!0)},className:"p-button-secondary",icon:"pi pi-eye"})})]}),(0,s.jsxs)("div",{className:"col-12 text-center mb-2",children:[z,(0,s.jsx)("br",{}),H]}),(0,s.jsx)(tt,{className:"logScroller"})]}),(0,s.jsx)("div",{children:!ie&&(0,s.jsx)("div",{children:(null===U||void 0===U?void 0:U.length)>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"lightblue-color",children:[q.name," Images"]}),(0,s.jsxs)(d.i,{value:U,stripedRows:!0,rowHover:!0,showGridlines:!0,expandedKeys:A,onToggle:function(e){return V(e.value)},loading:ve,children:[(0,s.jsx)(o.s,{field:"name",header:"Name",className:"lightblue-color",expander:!0}),(0,s.jsx)(o.s,{field:"last_updated",header:"Last Updated",align:"right",body:function(e){return e.data.last_updated?(0,s.jsx)(s.Fragment,{children:c(e.data.last_updated).format("YYYY-MM-DD HH:mm:ss")}):(0,s.jsx)("div",{})}}),(0,s.jsx)(o.s,{field:"status",header:"Status",align:"center",body:function(e){return e.data.status?(0,s.jsx)(s.Fragment,{children:e.data.status}):(0,s.jsx)("div",{children:e.data.status})}}),(0,s.jsx)(o.s,{field:"size",header:"Size",align:"right",body:function(e){return e.data.size?(0,s.jsx)(s.Fragment,{children:t(e.data.size)}):(0,s.jsx)("div",{children:t(e.data.size)})}}),(0,s.jsx)(o.s,{field:"id",header:"Action",align:"center",body:function(e){var t=R.filter((function(t){if(e.data.install.includes(t.pullTag))return t}));return t.length>0?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{children:(0,s.jsx)(l.z,{label:"Remove",onClick:function(e){rt("removeImage",t[0],"Remove "+t[0].pullTag+"?",e)},className:"p-button-primary",icon:"pi pi-trash"},"btn_234-"+e.data.id)},"btn_23433-"+e.data.id)}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.z,{label:"Pull",onClick:function(){var t;(t=e).data.platform?st(nt,"Pull Image "+t.data.install+" platform: "+t.data.platform+"?",t):st(nt,"Pull Image "+t.data.install+"?",t)},className:"p-button-secondary",icon:"pi pi-plus"})})}})]}),(0,s.jsx)(m.D,{template:lt,first:Fe,rows:Be,totalRecords:Ye,onPageChange:function(e){setTimeout((function(){He(e.first),Te(e.rows),Se(e.page+1),qe()}))}})]})})})]})}}}]);