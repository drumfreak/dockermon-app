"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7805],{7805:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var r=n(34051),o=n.n(r),a=n(85893),c=n(67294),i=n(11163),s=n(41664),l=n(66367),u=n(51436),d=n(25617),f=n(81961),h=n(27484),v=n.n(h),p=n(40424),m=n(99403),g=n(92814),y=n(25600),x=n(42896),b=n(58650),j=n(12018);function N(e,t,n,r,o,a,c){try{var i=e[a](c),s=i.value}catch(l){return void n(l)}i.done?t(s):Promise.resolve(s).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){N(a,r,o,c,i,"next",e)}function i(e){N(a,r,o,c,i,"throw",e)}c(void 0)}))}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e){(0,i.useRouter)();var t=(0,c.useState)(!0),n=t[0],r=t[1],h=(0,c.useRef)(n);h.current=n;var N=(0,c.useState)(null)[0],A=(0,d.v9)((function(e){return e.hosts.activeHost})),L=(0,c.useRef)(A);L.current=A;var R=(0,c.useState)(!1)[0];(0,c.useRef)(R).current=R;var T=(0,c.useState)(null),k=T[0],I=T[1];(0,c.useRef)(k).current=k;var O=(0,c.useState)(null),C=O[0],P=O[1];(0,c.useRef)(C).current=C;var D=(0,c.useState)(null)[0];(0,c.useRef)(D).current=D;var M=(0,c.useState)(null),E=M[0],F=(M[1],(0,c.useRef)(E));F.current=E;var Y=(0,c.useState)(!1),H=(Y[0],Y[1],(0,c.useState)(null)),_=H[0],G=H[1],K=(0,c.useRef)(_);K.current=_;var z=(0,c.useState)([]),B=z[0],U=z[1],V=(0,c.useRef)({});V.current=B;var X=(0,c.useState)(null),q=X[0],J=X[1],Q=(0,c.useRef)(q);Q.current=q;var W=(0,c.useState)(null),Z=W[0],$=W[1],ee=(0,c.useState)(""),te=ee[0],ne=ee[1];function re(){return oe.apply(this,arguments)}function oe(){return(oe=S(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={limit:15,sortKey:"activityLogs.updatedAt",sortType:"DESC"},k&&(t.contentType=k),C&&(t.contentId=C),e.next=5,f.u.getActivityLogs(t);case 5:if("success"!==(null===(n=e.sent)||void 0===n?void 0:n.status)){e.next=11;break}return e.next=9,G(n.data);case 9:console.log("activityLogs",n.data),setTimeout((function(){ae()}),1e3);case 11:r(!1);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(){return ce.apply(this,arguments)}function ce(){return(ce=S(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(t=K.current)||void 0===t?void 0:t.length)>0&&(n=K.current.map((function(e){return{status:e.contentName+e.action,date:v()(e.updatedAt).format("YYYY-MM-DD HH:mm:ss"),icon:"pi pi-shopping-cart",color:"#9C27B0"}})))&&(V.current=n,U(n));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if((0,c.useEffect)((function(){e.contentTypeLogs&&I(e.contentTypeLogs),e.contentId&&P(e.contentId),setTimeout((function(){ie(),re()}),400)}),[]),(0,c.useEffect)((function(){e.contentTypeLogs&&I(e.contentTypeLogs),e.contentId&&P(e.contentId),setTimeout((function(){ie(),re()}),400)}),[e.contentId]),N)return(0,a.jsxs)("div",{children:["Failed to load ActivityLogs: ",N]});var ie=function(){$({global:{value:null,matchMode:l.a6.CONTAINS},name:{operator:l.pg.AND,constraints:[{value:null,matchMode:l.a6.CONTAINS}]},project:{operator:l.pg.AND,constraints:[{value:null,matchMode:l.a6.CONTAINS}]},containerId:{operator:l.pg.AND,constraints:[{value:null,matchMode:l.a6.CONTAINS}]}})},se=function(e){F.current.emit("docker",{command:"removeActivityLog",activityLogId:e.activityLogId,hostId:L.current.id,callback:"dockerResuls_activityLogs"+e.id,hook:"removeActivityLog"})},le=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,p.V)({className:"confirm-dialogs",message:n,target:(null===r||void 0===r?void 0:r.currentTarget)?r.currentTarget:null,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:function(){switch(e){case"removeActivityLog":se(t);break;case"removeSelected":ue()}}})},ue=function(){Q.current.forEach((function(e){var t;0===(null===(t=e.containers)||void 0===t?void 0:t.length)&&se(e)})),J(null)};return(0,a.jsx)("div",{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"col-12 p-0 mt-2 pr-1 grid",children:[(0,a.jsx)("div",{className:"col-6",children:(0,a.jsxs)("h2",{children:[(0,a.jsx)(g.G,{icon:u.Pk,pull:"left",className:"fa-1x lightblue-color mt-0 pt-0",swapOpacity:!0}),"Activity Logs 234"]})}),(0,a.jsxs)("div",{className:"col-6 text-right pr-0",children:[(0,a.jsxs)("span",{className:"p-input-icon-left mr-3",children:[(0,a.jsx)("i",{className:"pi pi-search"}),(0,a.jsx)(y.o,{value:te,onChange:function(e){var t=e.target.value,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){w(e,t,n[t])}))}return e}({},Z);n.global.value=t,$(n),ne(t)},placeholder:"Keyword Search"})]}),(0,a.jsx)("button",{className:"p-button p-component p-button-secondary mt-1 p-2",label:"",onClick:function(){return re()},children:(0,a.jsx)(g.G,{icon:u.lUd,className:"mt-0 p-1",swapOpacity:!0})})]})]}),R&&(0,a.jsxs)("div",{className:"col-12",children:[(0,a.jsx)("h6",{children:"Timeline"}),(0,a.jsx)(j.T,{value:B,layout:"vertical",align:"top",content:function(e){return e.status+" "+e.date}})]}),(0,a.jsxs)(x.w,{value:_,stripedRows:!0,rowHover:!0,showGridlines:!0,selection:q,onSelectionChange:function(e){return function(e){J(e.value)}(e)},paginator:!0,rows:15,totalRecords:null===_||void 0===_?void 0:_.length,dataKey:"id",rowsPerPageOptions:[10,15,20,50,100,200],sortMode:"single",responsiveLayout:"scroll",sortField:"updatedAt",sortOrder:-1,filters:Z,filterDisplay:"menu",loading:h.current,globalFilterFields:["name","imageId","tag"],children:[(0,a.jsx)(b.s,{sortable:!0,field:"updatedAt",header:"Date",body:function(e){var t="/activity/"+e.id;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.default,{href:t,children:(0,a.jsx)("a",{className:"lightblue-color",children:(0,a.jsx)("b",{children:v()(e.updatedAt).format("MM/DD/YYYY - h:mm:ss a")})})})})}}),(0,a.jsx)(b.s,{sortable:!0,field:"host.name",body:function(e){if(!e.host)return(0,a.jsx)("div",{});var t="/hosts/"+e.host.id;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.default,{tooltip:"View "+e.host.name,href:t,children:(0,a.jsx)("a",{className:"lightblue-color",children:(0,a.jsx)("b",{children:e.host.name})})})})},header:"Host",filter:!0,filterPlaceholder:"Search by host",align:"left"}),(0,a.jsx)(b.s,{sortable:!0,field:"contentName",body:function(e){var t="/"+e.contentType+"/"+e.contentId;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.default,{href:t,children:(0,a.jsx)("a",{className:"lightblue-color",children:(0,a.jsx)("b",{children:e.contentName})})})})},header:"Name",filter:!0,filterPlaceholder:"Search by name",align:"left"}),(0,a.jsx)(b.s,{sortable:!0,field:"action",body:function(e){return(0,a.jsx)("div",{children:e.action})},header:"action",filter:!0,filterPlaceholder:"Search by action",align:"left"}),(0,a.jsx)(b.s,{field:"action",body:function(e){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(m.z,{label:"",onClick:function(t){le("removeActivityLog",e,"Remove "+e.name+"?",t)},className:"p-button-secondary",icon:"pi pi-trash"})})},header:"action",align:"left"}),(0,a.jsx)(b.s,{selectionMode:"multiple",headerStyle:{width:"3em"}})]}),(null===q||void 0===q?void 0:q.length)>0&&(0,a.jsx)("div",{className:"col-12 text-right pr-2",children:(0,a.jsx)(m.z,{className:"mt-2 p-button-warning",label:"Remove Selected",icon:"fa fa-trash",onClick:function(e){return le("removeSelected",null,"Remove Selected Activity Logs?",e)}})})]})})}},81961:function(e,t,n){n.d(t,{u:function(){return l}});var r=n(22946),o=n(11752),a=n(51388),c=(0,o.default)().publicRuntimeConfig,i="".concat(c.apiUrl),s=new r.X(""),l={results:s.asObservable(),getActivityLogs:function(e){return a.h.post("".concat(i,"/activityLogs"),e).then((function(e){if("success"===e.status)return s.next(e),e;throw Error(e.message)})).catch((function(e){s.next(null),console.log(e)}))},getActivityLogById:function(e){return a.h.get("".concat(i,"/activityLogs/").concat(e)).then((function(e){if("success"===e.status)return s.next(e),e;throw Error(e.message)})).catch((function(e){s.next(null),console.log(e)}))}}}}]);