"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9989],{79989:function(e,r,t){t.r(r),t.d(r,{default:function(){return S}});var n=t(34051),a=t.n(n),i=t(85893),s=t(67294),c=t(11163),o=t(41664),u=t(42896),l=t(58650),d=t(45795),f=t(25617),m=t(28565),h=t(57191),p=t(99403),v=t(40424),g=t(92814),x=t(66367),b=t(25600),j=t(51436);function y(e,r,t,n,a,i,s){try{var c=e[i](s),o=c.value}catch(u){return void t(u)}c.done?r(o):Promise.resolve(o).then(n,a)}function k(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var i=e.apply(r,t);function s(e){y(i,n,a,s,c,"next",e)}function c(e){y(i,n,a,s,c,"throw",e)}s(void 0)}))}}function w(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function N(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){w(e,r,t[r])}))}return e}function S(e){var r=(0,c.useRouter)(),t=(0,s.useState)(!0),n=t[0],y=t[1],w=(0,s.useRef)(n);w.current=n;var S=(0,s.useState)()[0],I=(0,f.v9)((function(e){return e.hosts.hosts})),O=(0,s.useRef)(I);O.current=I;var C=(0,f.v9)((function(e){return e.hosts.activeHost})),R=(0,s.useRef)(C);R.current=C;var T=(0,s.useState)(),F=T[0],P=T[1],z=(0,s.useRef)(F);z.current=F;var A=(0,f.v9)((function(e){return e.images})),D=(0,s.useState)(),E=D[0],M=D[1],V=(0,s.useRef)(E);V.current=E;var _=(0,s.useState)(!1),G=_[0],L=_[1],q=(0,s.useState)(),H=q[0],K=q[1];(0,s.useRef)(H).current=H;var U=(0,s.useState)(),Y=U[0],B=U[1],J=(0,s.useRef)(Y);J.current=Y;var Q=(0,s.useState)(),W=Q[0],X=Q[1],Z=(0,s.useState)(""),$=Z[0],ee=Z[1];function re(){return te.apply(this,arguments)}function te(){return(te=k(a().mark((function t(){var n,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(G){t.next=4;break}return t.next=4,ie();case 4:if(oe(),!(null===(n=r.query)||void 0===n?void 0:n.hostId)){t.next=14;break}if(!O.current){t.next=11;break}return i=O[r.query.hostId],P(i),setTimeout((function(){return ne()})),t.abrupt("return");case 11:return P(e.host),setTimeout((function(){return ne()})),t.abrupt("return");case 14:if(!e.host){t.next=18;break}return P(e.host),setTimeout((function(){return ne()})),t.abrupt("return");case 18:C&&(P(R.current),setTimeout((function(){return ne()})));case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ne(){return ae.apply(this,arguments)}function ae(){return(ae=k(a().mark((function e(){var r,t,n,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=N({},A),C||(null===(r=z.current)||void 0===r?void 0:r.id)){e.next=4;break}return e.abrupt("return");case 4:if(A&&(null===(n=A[null===(t=z.current)||void 0===t?void 0:t.id])||void 0===n?void 0:n.images)){e.next=6;break}return e.abrupt("return");case 6:i=A[z.current.id].images,s=Object.keys(i).map((function(e){return i[e]})),K(s),y(!1);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return se.apply(this,arguments)}function se(){return(se=k(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!G){e.next=2;break}return e.abrupt("return");case 2:return L(!0),e.next=5,m.L.getSocket();case 5:return r=e.sent,M(r),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(){return(ce=k(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V.current.emit("docker",{command:"listImages",callback:"imagesList",hostId:z.current.id}),y(!0),setTimeout((function(){y(!1)}),1e3);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,s.useEffect)(k(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:re();case 1:case"end":return e.stop()}}),e)}))),[]),(0,s.useEffect)(k(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:re();case 1:case"end":return e.stop()}}),e)}))),[C,A]),(0,s.useEffect)((function(){}),[C,A]);var oe=function(){X({global:{value:null,matchMode:x.a6.CONTAINS},name:{operator:x.pg.AND,constraints:[{value:null,matchMode:x.a6.CONTAINS}]},project:{operator:x.pg.AND,constraints:[{value:null,matchMode:x.a6.CONTAINS}]},containerId:{operator:x.pg.AND,constraints:[{value:null,matchMode:x.a6.CONTAINS}]}})};if(S)return(0,i.jsxs)("div",{children:["Failed to load Images: ",S]});if(!A)return(0,i.jsx)("div",{children:"No Images."});if(0===A.length)return(0,i.jsx)("div",{children:"No Images."});var ue=function(e){var r;V.current.emit("docker",{command:"removeImage",imageId:e.imageId,hostId:null===(r=e.host)||void 0===r?void 0:r.id,callback:"dockerResuls_images"+e.id,hook:"removeImage"})},le=function(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,v.V)({className:"confirm-dialogs",message:t,target:(null===n||void 0===n?void 0:n.currentTarget)?n.currentTarget:null,header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:function(){switch(e){case"removeImage":ue(r);break;case"removeSelected":de()}}})},de=function(){J.current.forEach((function(e){var r;0===(null===(r=e.containers)||void 0===r?void 0:r.length)&&ue(e)})),B(null)};return(0,i.jsx)("div",{children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"col-12 p-0 mt-2 pr-1 grid",children:[(0,i.jsx)("div",{className:"col-6",children:(0,i.jsxs)("h2",{children:[(0,i.jsx)(g.G,{icon:j.Yws,pull:"left",className:"fa-1x lightblue-color mt-0 pt-0",swapOpacity:!0}),"Docker Images"]})}),(0,i.jsxs)("div",{className:"col-6 text-right pr-0",children:[(0,i.jsxs)("span",{className:"p-input-icon-left mr-3",children:[(0,i.jsx)("i",{className:"pi pi-search"}),(0,i.jsx)(b.o,{value:$,onChange:function(e){var r=e.target.value,t=N({},W);t.global.value=r,X(t),ee(r)},placeholder:"Keyword Search"})]}),(0,i.jsx)(p.z,{label:"Image",className:"p-button-secondary mr-2",icon:"fa fa-plus",onClick:function(){return r.push("/images/create")}}),(0,i.jsx)("button",{className:"p-button p-component p-button-secondary mt-1 p-2",label:"",onClick:function(){return function(){return ce.apply(this,arguments)}()},children:(0,i.jsx)(g.G,{icon:j.lUd,className:"mt-0 p-1",swapOpacity:!0})})]})]}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(u.w,{value:H,stripedRows:!0,rowHover:!0,showGridlines:!0,selection:Y,onSelectionChange:function(e){return function(e){B(e.value)}(e)},paginator:!0,rows:15,totalRecords:null===H||void 0===H?void 0:H.length,dataKey:"id",rowsPerPageOptions:[10,15,20,50,100,200],sortMode:"single",responsiveLayout:"scroll",sortField:"name",sortOrder:1,filters:W,filterDisplay:"menu",loading:w.current,globalFilterFields:["name","imageId","tag"],children:[(0,i.jsx)(l.s,{sortable:!0,field:"name",header:"Name",filter:!0,filterPlaceholder:"Search by name",body:function(e){e.name&&""!==e.name||(e.name=e.imageId.substring(0,16));var r=e.imageId.substring(0,16);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.default,{href:"/images/[id]",as:"/images/".concat(e.id),children:(0,i.jsx)("a",{className:"lightblue-color",children:(0,i.jsx)("b",{children:e.name})})}),(0,i.jsx)("br",{}),(0,i.jsx)(o.default,{className:"mt-1",href:"/images/[id]",as:"/images/".concat(e.id),children:(0,i.jsx)("a",{children:r})})]})}}),(0,i.jsx)(l.s,{sortable:!0,field:"tag",header:"Tag",filter:!0,filterPlaceholder:"Search by Tag",body:function(e){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.default,{href:"/images/[id]",as:"/images/".concat(e.id),children:(0,i.jsx)("a",{className:"lightblue-color",children:(0,i.jsx)("b",{children:e.tag})})})})}}),(0,i.jsx)(l.s,{sortable:!0,field:"fileSize",header:"Size",align:"center",body:function(e){return e.fileSize>0?(0,i.jsx)(i.Fragment,{children:h.t.bytes(e.fileSize)}):(0,i.jsx)("div",{children:"--"})}}),(0,i.jsx)(l.s,{sortable:!0,field:"dockerVersion",header:"Docker Version",filter:!0,filterPlaceholder:"Search by Docker Version",align:"center",body:function(e){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.default,{href:"/images/[id]",as:"/images/".concat(e.id),children:(0,i.jsx)("a",{children:e.dockerVersion})})})}}),(0,i.jsx)(l.s,{sortable:!0,field:"status",header:"Status",align:"center",body:function(e){var r;if((null===e||void 0===e||null===(r=e.containers)||void 0===r?void 0:r.length)>0)return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.default,{href:"/images/[id]",as:"/images/".concat(e.id),children:(0,i.jsx)("a",{children:(0,i.jsx)(d.C,{size:"",value:"In Use",severity:"success"})})})})}}),(0,i.jsx)(l.s,{field:"id",header:"Actions",align:"center",body:function(e){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(p.z,{label:"",onClick:function(r){le("removeImage",e,"Remove "+e.pullTag+"?",r)},className:"p-button-secondary",icon:"pi pi-trash"})})}}),(0,i.jsx)(l.s,{selectionMode:"multiple",headerStyle:{width:"3em"}})]}),(null===Y||void 0===Y?void 0:Y.length)>0&&(0,i.jsx)("div",{className:"col-12 text-right pr-2",children:(0,i.jsx)(p.z,{className:"mt-2 p-button-warning",label:"Remove Selected",icon:"fa fa-trash",onClick:function(e){return le("removeSelected",null,"Remove Selected Images?",e)}})})]})]})})}}}]);